
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the PredictPro platform, authenticated via Firebase.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity, from Firebase Auth."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "oneXBetId": {
          "type": "string",
          "description": "User's 1xBet account ID."
        },
        "role": {
          "type": "string",
          "description": "User's role (User, Assistant, Admin, SuperAdmin).",
          "enum": [
            "User",
            "Assistant",
            "Admin",
            "SuperAdmin"
          ]
        },
        "isSuspended": {
          "type": "boolean",
          "description": "Indicates if the user account is suspended."
        },
        "referredBy": {
            "type": "string",
            "description": "The ID of the user who referred this user."
        },
        "assistantAgreementAccepted": {
            "type": "boolean",
            "description": "Indicates if the assistant has accepted the onboarding agreement.",
            "default": false
        },
        "assistantPaymentNumber": {
          "type": "string",
          "description": "The payment number provided by an assistant during onboarding for their salary."
        },
        "companyAgreementAccepted": {
            "type": "boolean",
            "description": "Indicates if the user has accepted the general company agreement.",
            "default": false
        }
      },
      "required": [
        "id",
        "email",
        "role"
      ]
    },
    "License": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "License",
      "type": "object",
      "description": "Represents a game license for a user, valid for a set number of rounds. Activated by an Admin.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the License entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N License)"
        },
        "gameType": {
          "type": "string",
          "description": "Type of game the license is for (Crash, Aviator, Mines & Gems, VIP Slip).",
          "enum": [
            "Crash",
            "Aviator",
            "Mines & Gems",
            "VIP Slip"
          ]
        },
        "roundsRemaining": {
          "type": "number",
          "description": "Number of prediction rounds remaining for the license. Defaults to 100 on activation.",
          "default": 100
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates if the license is active. A license is active if roundsRemaining > 0."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the license was activated."
        }
      },
      "required": [
        "id",
        "userId",
        "gameType"
      ]
    },
    "Prediction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Prediction",
      "type": "object",
      "description": "Represents a game prediction generated for a user for 1xBet.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Prediction entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Prediction)"
        },
        "licenseId": {
          "type": "string",
          "description": "Reference to License used for this prediction."
        },
        "gameType": {
          "type": "string",
          "description": "Type of game the prediction is for."
        },
        "predictionData": {
          "type": "object",
          "description": "JSON data containing the prediction details, formatted as a VIP Slip or game-specific data for 1xBet."
        },
        "disclaimer": {
          "type": "string",
          "description": "The required legal disclaimer for predictions."
        },
        "status": {
          "type": "string",
          "description": "The outcome of the prediction.",
          "enum": ["pending", "won", "lost"]
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the prediction was created."
        }
      },
      "required": [
        "id",
        "userId",
        "licenseId",
        "gameType",
        "predictionData",
        "status",
        "timestamp"
      ]
    },
    "AuditLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditLog",
      "type": "object",
      "description": "Represents an audit log entry for security and monitoring.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AuditLog entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User who performed the action. (Relationship: User 1:N AuditLog)"
        },
        "action": {
          "type": "string",
          "description": "Action performed (e.g., 'prediction_request', 'bypass_attempt', 'license_expired')."
        },
        "details": {
          "type": "string",
          "description": "JSON data containing the details of the action."
        },
        "ipAddress": {
          "type": "string",
          "description": "IP address of the user who performed the action."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the action occurred."
        }
      },
      "required": [
        "id",
        "userId",
        "action",
        "timestamp"
      ]
    },
    "Prompt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Prompt",
      "type": "object",
      "description": "Represents an editable AI prompt template for Genkit flows.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the prompt (e.g., 'generateVipSlipPrompt')."
        },
        "name": {
          "type": "string",
          "description": "A user-friendly name for the prompt."
        },
        "content": {
          "type": "string",
          "description": "The full text content of the prompt template."
        },
        "lastModified": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of when the prompt was last updated."
        },
        "version": {
          "type": "number",
          "description": "A version number for tracking changes."
        }
      },
      "required": [
        "id",
        "name",
        "content"
      ]
    },
    "GameStatus": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "GameStatus",
      "type": "object",
      "description": "Stores the operational status of a game.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique ID for the game (e.g., 'aviator')."
        },
        "name": {
          "type": "string",
          "description": "Display name of the game (e.g., 'Aviator')."
        },
        "isEnabled": {
          "type": "boolean",
          "description": "Whether the game is currently enabled for users.",
          "default": true
        },
        "disabledReason": {
          "type": "string",
          "description": "The reason displayed to users if the game is disabled."
        }
      },
      "required": ["id", "name", "isEnabled"]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "A global notification or broadcast message for users.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique ID for the notification."
        },
        "message": {
          "type": "string",
          "description": "The content of the broadcast message (supports Markdown)."
        },
        "targetAudience": {
          "type": "string",
          "description": "The target audience for the notification.",
          "enum": ["all", "premium", "staff", "user"]
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user this notification is for, if it's not a broadcast."
        },
        "senderId": {
          "type": "string",
          "description": "The ID of the admin who sent the message."
        },
        "senderEmail": {
          "type": "string",
          "description": "The email of the admin who sent the message."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp of when the notification was created."
        }
      },
      "required": ["id", "message", "targetAudience", "createdAt"]
    },
    "AdminChatMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Admin Chat Message",
      "type": "object",
      "description": "A single message in an admin's support chat with the AI assistant.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the message."
        },
        "text": {
          "type": "string",
          "description": "The content of the message."
        },
        "sender": {
          "type": "string",
          "enum": ["user", "model"],
          "description": "Who sent the message ('user' for the admin, 'model' for the AI)."
        },
        "isUser": {
            "type": "boolean",
            "description": "True if the sender is the human admin."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the message was sent."
        }
      },
      "required": ["id", "text", "sender", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Managed via Firebase, but profile data mirrored for app logic.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user from Firebase."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/user_licenses/{licenseId}",
        "definition": {
          "entityName": "License",
          "schema": {
            "$ref": "#/backend/entities/License"
          },
          "description": "Stores game licenses for a user. Each license expires after 100 prediction rounds.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            },
            {
              "name": "licenseId",
              "description": "Unique identifier for the license."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/predictions/{predictionId}",
        "definition": {
          "entityName": "Prediction",
          "schema": {
            "$ref": "#/backend/entities/Prediction"
          },
          "description": "Stores game predictions made by a user. Each prediction consumes one round from a license.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            },
            {
              "name": "predictionId",
              "description": "Unique identifier for the prediction."
            }
          ]
        }
      },
       {
        "path": "/users/{userId}/admin_chat_messages/{messageId}",
        "definition": {
          "entityName": "AdminChatMessage",
          "schema": { "$ref": "#/backend/entities/AdminChatMessage" },
          "description": "Stores the history of an admin's conversation with the AI assistant.",
          "params": [
            { "name": "userId", "description": "The admin's user ID." },
            { "name": "messageId", "description": "Unique ID for the chat message." }
          ]
        }
      },
      {
        "path": "/auditlogs/{auditLogId}",
        "definition": {
          "entityName": "AuditLog",
          "schema": {
            "$ref": "#/backend/entities/AuditLog"
          },
          "description": "Global audit log for important system events, especially security-related ones.",
          "params": [
            {
              "name": "auditLogId",
              "description": "Unique identifier for the audit log entry."
            }
          ]
        }
      },
      {
        "path": "/prompts/{promptId}",
        "definition": {
          "entityName": "Prompt",
          "schema": {
            "$ref": "#/backend/entities/Prompt"
          },
          "description": "Stores editable AI prompt templates for Genkit flows. Only admins can edit.",
          "params": [
            {
              "name": "promptId",
              "description": "Unique identifier for the prompt (e.g. 'generateVipSlipPrompt')."
            }
          ]
        }
      },
      {
        "path": "/game_status/{gameId}",
        "definition": {
          "entityName": "GameStatus",
          "schema": {
            "$ref": "#/backend/entities/GameStatus"
          },
          "description": "Stores the operational status of each game (e.g., enabled, disabled).",
          "params": [
            {
              "name": "gameId",
              "description": "The unique identifier for the game (e.g., 'aviator')."
            }
          ]
        }
      },
      {
        "path": "/notifications/{notificationId}",
        "definition": {
          "entityName": "Notification",
          "schema": {
            "$ref": "#/backend/entities/Notification"
          },
          "description": "Stores global broadcast messages for users.",
          "params": [
            {
              "name": "notificationId",
              "description": "The unique identifier for the notification."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is updated to remove all payment and pricing-related collections (`plans`, `pending_payments`, `preVerifiedPayments`, `transactions`). The User entity has been simplified by removing `balance`. The License entity no longer has a `paymentVerified` field. This aligns with the request to completely remove all financial transaction functionality from the app."
  }
}
